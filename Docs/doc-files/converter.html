<!DOCTYPE html>

<html>
<head>
  <link rel="icon" type="image/png" href="../../images/fish.png">
  <title>converter.jl</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
  <link rel="stylesheet" media="all" href="./jocco.css" />
  <link rel="stylesheet" href="http://dobtco.github.io/jquery-resizable-columns/dist/jquery.resizableColumns.css">
  <script type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>
  <!-- jQuery -->
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script src="http://dobtco.github.io/jquery-resizable-columns/dist/jquery.resizableColumns.min.js"></script>
  <script>
    $(function(){
      $("table").resizableColumns({
        store: window.store
      });
    });
  </script>
</head>
<body>
<nav>
	<ul>
		<li><a href="../index.html#">Home</a></li>
		<li>
      		<a href="openBF.html">openBF.jl <span class="caret"></span></a>
			<div>
				<ul>
        <li><a href="main.html#">main.jl</a>

<li><a href="BTypes.html#">BTypes.jl<span class="caret"></span></a>
<div>
<ul><li><a href="BTypes.html#::Vessel
">::Vessel
</a></li>
<li><a href="BTypes.html#::Heart
">::Heart
</a></li>
<li><a href="BTypes.html#::Blood
">::Blood
</a></li>
</ul>
</div>
</li><li><a href="initialise.html#">initialise.jl<span class="caret"></span></a>
<div>
<ul><li><a href="initialise.html#projectPreamble
">projectPreamble
</a></li>
<li><a href="initialise.html#writeScripts
">writeScripts
</a></li>
<li><a href="initialise.html#cleanLibrary
">cleanLibrary
</a></li>
<li><a href="initialise.html#readModelData
">readModelData
</a></li>
<li><a href="initialise.html#initialiseVessel
">initialiseVessel
</a></li>
<li><a href="initialise.html#loadInputData
">loadInputData
</a></li>
<li><a href="initialise.html#loadGlobalConstants
">loadGlobalConstants
</a></li>
</ul>
</div>
</li><li><a href="boundary_conditions.html#">boundary_conditions.jl<span class="caret"></span></a>
<div>
<ul><li><a href="boundary_conditions.html#setInletBC
">setInletBC
</a></li>
<li><a href="boundary_conditions.html#sinHeaviside
">sinHeaviside
</a></li>
<li><a href="boundary_conditions.html#heaviside
">heaviside
</a></li>
<li><a href="boundary_conditions.html#gauss
">gauss
</a></li>
<li><a href="boundary_conditions.html#inputFromData
">inputFromData
</a></li>
<li><a href="boundary_conditions.html#inletCompatibility
">inletCompatibility
</a></li>
<li><a href="boundary_conditions.html#setOutletBC
">setOutletBC
</a></li>
<li><a href="boundary_conditions.html#outletCompatibility
">outletCompatibility
</a></li>
<li><a href="boundary_conditions.html#wk3
">wk3
</a></li>
<li><a href="boundary_conditions.html#updateGhostCells
">updateGhostCells
</a></li>
</ul>
</div>
</li><li><a href="junctions.html#">junctions.jl<span class="caret"></span></a>
<div>
<ul><li><a href="junctions.html#joinVessels
">joinVessels
</a></li>
</ul>
</div>
</li><li><a href="conjunctions.html#">conjunctions.jl<span class="caret"></span></a>
<div>
<ul><li><a href="conjunctions.html#solveConjunction
">solveConjunction
</a></li>
<li><a href="conjunctions.html#calculateWstarConj
">calculateWstarConj
</a></li>
<li><a href="conjunctions.html#calculateFofUconj
">calculateFofUconj
</a></li>
<li><a href="conjunctions.html#calculateJacobianConj
">calculateJacobianConj
</a></li>
</ul>
</div>
</li><li><a href="bifurcations.html#">bifurcations.jl<span class="caret"></span></a>
<div>
<ul><li><a href="bifurcations.html#solveBifurcation
">solveBifurcation
</a></li>
<li><a href="bifurcations.html#calculateWstarBif
">calculateWstarBif
</a></li>
<li><a href="bifurcations.html#calculateFofUBif
">calculateFofUBif
</a></li>
<li><a href="bifurcations.html#calculateJacobianBif
">calculateJacobianBif
</a></li>
</ul>
</div>
</li><li><a href="godunov.html#">godunov.jl<span class="caret"></span></a>
<div>
<ul><li><a href="godunov.html#Godunov
">Godunov
</a></li>
<li><a href="godunov.html#riemannSolver
">riemannSolver
</a></li>
<li><a href="godunov.html#fL
">fL
</a></li>
<li><a href="godunov.html#fR
">fR
</a></li>
<li><a href="godunov.html#flux
">flux
</a></li>
<li><a href="godunov.html#source
">source
</a></li>
<li><a href="godunov.html#calculateDeltaT
">calculateDeltaT
</a></li>
<li><a href="godunov.html#solveModel
">solveModel
</a></li>
</ul>
</div>
</li><li><a href="MUSCL.html#">MUSCL.jl<span class="caret"></span></a>
<div>
<ul><li><a href="MUSCL.html#computeFlux
">computeFlux
</a></li>
<li><a href="MUSCL.html#minMod
">minMod
</a></li>
<li><a href="MUSCL.html#maxmod
">maxmod
</a></li>
<li><a href="MUSCL.html#minmod
">minmod
</a></li>
<li><a href="MUSCL.html#superBee
">superBee
</a></li>
<li><a href="MUSCL.html#computeLimiter
">computeLimiter
</a></li>
<li><a href="MUSCL.html#MUSCL
">MUSCL
</a></li>
</ul>
</div>
</li><li><a href="converter.html#">converter.jl<span class="caret"></span></a>
<div>
<ul><li><a href="converter.html#waveSpeed
">waveSpeed
</a></li>
<li><a href="converter.html#pressure
">pressure
</a></li>
<li><a href="converter.html#areaFromPressure
">areaFromPressure
</a></li>
<li><a href="converter.html#riemannInvariants
">riemannInvariants
</a></li>
<li><a href="converter.html#rI2uc
">rI2uc
</a></li>
<li><a href="converter.html#calculatePrimitives
">calculatePrimitives
</a></li>
</ul>
</div>
</li><li><a href="check_convergence.html#">check_convergence.jl<span class="caret"></span></a>
<div>
<ul><li><a href="check_convergence.html#checkAllQuantities
">checkAllQuantities
</a></li>
<li><a href="check_convergence.html#extractWaveform
">extractWaveform
</a></li>
<li><a href="check_convergence.html#resampleAndCalculateError
">resampleAndCalculateError
</a></li>
</ul>
</div>
</li><li><a href="IOutils.html#">IOutils.jl<span class="caret"></span></a>
<div>
<ul><li><a href="IOutils.html#openTempFiles
">openTempFiles
</a></li>
<li><a href="IOutils.html#closeTempFiles
">closeTempFiles
</a></li>
<li><a href="IOutils.html#saveTempData
">saveTempData
</a></li>
<li><a href="IOutils.html#transferTempToOut">transferTempToOut</a></li>
</ul>
</div>




				</ul>
			</div>
		</li>
		<li><a href="../doc-index.html">API Index</a></li>
	</ul>
</nav>
  <div id="container">
    <div id="background"></div>
    <table cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <th class="docs" data-resizable-column-id="docs">
            <h1>
              converter.jl
            </h1>
          </th>
          <th class="code" data-resizable-column-id="code">
          </th>
        </tr>
      </thead>
      <tbody>

<tr id="section-1">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-1">&#182;</a>
  </div>
  <p>This file contains all the functions used within <code>openBF</code> to convert quantities. In particular, the following functions are provided</p>
<ul>
<li><a href="converter.html#waveSpeed"><code>waveSpeed</code></a>: <span class="math inline">\(A \rightarrow c\)</span>;</li>
<li><a href="converter.html#pressure"><code>pressure</code></a>: <span class="math inline">\(A \rightarrow P\)</span>;</li>
<li><a href="converter.html#areaFromPressure"><code>areaFromPressure</code></a>: <span class="math inline">\(P \rightarrow A\)</span>;</li>
<li><a href="converter.html#riemannInvariants"><code>riemannInvariants</code></a>: <span class="math inline">\((u, c) \rightarrow (W_1, W_2)\)</span>;</li>
<li><a href="converter.html#rI2uc"><code>rI2uc</code></a>: <span class="math inline">\((W_1, W_2) \rightarrow (u, c)\)</span>.</li>
</ul>

</td>
<td class="code">
<div class="highlight"><pre>
</pre></div>
</td>
</tr>

<tr id="section-2">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-2">&#182;</a>
  </div>
  <p>Wave speed <span class="math display">\[
  c = \sqrt{\frac{3}{2}\gamma \sqrt{A}}, \quad
    \gamma = \frac{\beta}{3 \rho R_0 \sqrt{\pi}}.
\]</span></p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-3">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-3">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>waveSpeed</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>c::Float</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>::Float</code> cross sectional area.</td>
</tr>
<tr class="even">
<td align="left"><code>gamma</code></td>
<td align="left"><code>::Float</code> elastic constant.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>c</code></td>
<td align="left"><code>::Float</code> wave speed given cross sectional area A.</td>
</tr>
</tbody>
</table>
<p><a name="waveSpeed"></a></p>

</td>
<td class="code">
<div class="highlight"><pre><span class="k">function</span><span class="nf"> waveSpeed</span><span class="p">(</span><span class="n">A</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span> <span class="n">gamma</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">gamma</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-4">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-4">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>waveSpeed</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>c::Array{Float, 1}</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>::Array{Float, 1}</code> cross sectional area.</td>
</tr>
<tr class="even">
<td align="left"><code>gamma</code></td>
<td align="left"><code>::Float</code> elastic constant.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Functioning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">To compute the wave speed along the entire vessel, <code>waveSpeed</code> is re-defined to handle also a vector of <code>A</code>s. <code>waveSpeed</code> is called recursively with the same <code>gamma</code> along the vessel.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>c</code></td>
<td align="left"><code>::Arrary{Float, 1}</code> wave speed given cross sectional area A.</td>
</tr>
</tbody>
</table>
<p><a name="waveSpeed2"></a></p>

</td>
<td class="code">
<div class="highlight"><pre><span class="k">function</span><span class="nf"> waveSpeed</span><span class="p">(</span><span class="n">A</span> <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="n">gamma</span> <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="n">c</span> <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">})</span>

  <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">waveSpeed</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">gamma</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
  <span class="k">end</span>

  <span class="k">return</span> <span class="n">c</span>
<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-5">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-5">&#182;</a>
  </div>
  <p>Trans-mural pressure <span class="math display">\[
  P = P_{ext} + \beta \left[\left(\frac{A}{A_0}\right)^{1/2} -1 \right], \quad
    \beta = \sqrt{\frac{\pi}{A_0}} \frac{h_0 E}{1 - \sigma^2}.
\]</span></p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-6">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-6">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>pressure</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>P::Float</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>::Float</code> cross sectional area.</td>
</tr>
<tr class="even">
<td align="left"><code>A0</code></td>
<td align="left"><code>::Float</code> unstressed cross sectional area.</td>
</tr>
<tr class="odd">
<td align="left"><code>beta</code></td>
<td align="left"><code>::Float</code> elastic constant.</td>
</tr>
<tr class="even">
<td align="left"><code>Pext</code></td>
<td align="left"><code>::Float</code> constant external pressure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left"><code>::Float</code> trans-mural pressure given the cross sectional area <code>A</code>.</td>
</tr>
</tbody>
</table>
<p><a name="pressure"></a></p>

</td>
<td class="code">
<div class="highlight"><pre><span class="k">function</span><span class="nf"> pressure</span><span class="p">(</span><span class="n">A</span>    <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span> <span class="n">A0</span>   <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span>
                  <span class="n">beta</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span> <span class="n">Pext</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">Pext</span> <span class="o">+</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="n">A0</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span>

<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-7">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-7">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>pressure</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>P::Array{Float, 1}</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>::Array{Float, 1}</code> cross sectional area.</td>
</tr>
<tr class="even">
<td align="left"><code>A0</code></td>
<td align="left"><code>::Float</code> unstressed cross sectional area.</td>
</tr>
<tr class="odd">
<td align="left"><code>beta</code></td>
<td align="left"><code>::Float</code> elastic constant.</td>
</tr>
<tr class="even">
<td align="left"><code>Pext</code></td>
<td align="left"><code>::Float</code> constant external pressure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Functioning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">To compute the pressure along the entire vessel, <code>pressure</code> is re-defined to handle also a vector of <code>A</code>s. <code>pressure</code> is called recursively with the same <code>beta</code> along the vessel.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left"><code>::Array{Float, 1}</code> trans-mural pressure given the cross sectional area <code>A</code>.</td>
</tr>
</tbody>
</table>
<p>function pressure(A :: Array{Float64, 1}, A0 :: Float64, beta :: Float64, Pext :: Float64)</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-8">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-8">&#182;</a>
  </div>
  <p>p = zeros(Float64, length(A))</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-9">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-9">&#182;</a>
  </div>
  <p>for i in 1:length(A) p[i] = Pext + beta*(sqrt(A[i]/A0) - 1.)</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-10">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-10">&#182;</a>
  </div>
  <p>end</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-11">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-11">&#182;</a>
  </div>
  <p>return p end</p>

</td>
<td class="code">
<div class="highlight"><pre>
<span class="k">function</span><span class="nf"> pressure</span><span class="p">(</span><span class="n">A</span>    <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="n">A0</span>   <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span>
                  <span class="n">beta</span> <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span><span class="mi">1</span><span class="p">},</span>  <span class="n">Pext</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span>
                  <span class="n">p</span> <span class="p">::</span> <span class="n">Array</span><span class="p">{</span><span class="kt">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">})</span>

  <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Pext</span> <span class="o">+</span> <span class="n">beta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">A0</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">return</span> <span class="n">p</span>
<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-12">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-12">&#182;</a>
  </div>
  <p>Trans-mural pressure can be inverted to find cross sectional area as <span class="math display">\[
  A = A_0 \left( \frac{P-P_{ext}}{\beta} +1 \right)^2.
\]</span></p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-13">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-13">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>areaFromPressure</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>A::Float</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left"><code>::Float</code> cross sectional area.</td>
</tr>
<tr class="even">
<td align="left"><code>A0</code></td>
<td align="left"><code>::Float</code> unstressed cross sectional area.</td>
</tr>
<tr class="odd">
<td align="left"><code>beta</code></td>
<td align="left"><code>::Float</code> elastic constant.</td>
</tr>
<tr class="even">
<td align="left"><code>Pext</code></td>
<td align="left"><code>::Float</code> constant external pressure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>::Float</code> cross sectional area given the trans-mural pressure <code>P</code>.</td>
</tr>
</tbody>
</table>
<p><a name="areaFromPressure"></a></p>

</td>
<td class="code">
<div class="highlight"><pre><span class="k">function</span><span class="nf"> areaFromPressure</span><span class="p">(</span><span class="n">P</span>    <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span> <span class="n">A0</span>   <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span>
                          <span class="n">beta</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span> <span class="n">Pext</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">)</span>

   <span class="k">return</span> <span class="n">A0</span> <span class="o">*</span> <span class="p">((</span><span class="n">P</span><span class="o">-</span><span class="n">Pext</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">((</span><span class="n">P</span><span class="o">-</span><span class="n">Pext</span><span class="p">)</span><span class="o">/</span><span class="n">beta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-14">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-14">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>areaFromPressure</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>A::Float</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>P</code></td>
<td align="left"><code>::Float</code> cross sectional area.</td>
</tr>
<tr class="even">
<td align="left"><code>A0</code></td>
<td align="left"><code>::Float</code> unstressed cross sectional area.</td>
</tr>
<tr class="odd">
<td align="left"><code>beta</code></td>
<td align="left"><code>::Float</code> elastic constant.</td>
</tr>
<tr class="even">
<td align="left"><code>Pext</code></td>
<td align="left"><code>::Float</code> constant external pressure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Functioning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">To compute the cross sectional area along the entire vessel, <code>areaFromPressure</code> is re-defined to handle also a vector of <code>P</code>s. <code>areaFromPressure</code> is called recursively with the same <code>beta</code> along the vessel.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>A</code></td>
<td align="left"><code>::Float</code> cross sectional area given the trans-mural pressure <code>P</code>.</td>
</tr>
</tbody>
</table>
<p>function areaFromPressure(P :: Array{Float64, 1}, A0 :: Float64, beta :: Float64, Pext :: Float64)</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-15">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-15">&#182;</a>
  </div>
  <p>a = zeros(Float64, length(P))</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-16">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-16">&#182;</a>
  </div>
  <p>for i in 1:length(P) a[i] = areaFromPressure(P[i], A0, beta)</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-17">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-17">&#182;</a>
  </div>
  <p>end</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-18">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-18">&#182;</a>
  </div>
  <p>return a end</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-19">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-19">&#182;</a>
  </div>
  <p>Riemann invariants are computed from <code>u</code> and <code>c</code> values as <span class="math display">\[
  W_1 = u - 4c, \quad W_2 = u + 4c.
\]</span></p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-20">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-20">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>riemannInvariants</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>W1::Float</code>, <code>w2::Float</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>i</code></td>
<td align="left"><code>::Float</code> cell index.</td>
</tr>
<tr class="even">
<td align="left"><code>v</code></td>
<td align="left"><code>::Vessel</code> vessel data structure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>W1</code></td>
<td align="left"><code>::Float</code> backward Riemann invariant.</td>
</tr>
<tr class="even">
<td align="left"><code>W2</code></td>
<td align="left"><code>::Float</code> forward Riemann invariant.</td>
</tr>
</tbody>
</table>
<p><a name="riemannInvariants"></a></p>

</td>
<td class="code">
<div class="highlight"><pre><span class="k">function</span><span class="nf"> riemannInvariants</span><span class="p">(</span><span class="n">i</span> <span class="p">::</span> <span class="kt">Int64</span><span class="p">,</span> <span class="n">v</span> <span class="p">::</span> <span class="n">Vessel</span><span class="p">)</span>

  <span class="n">W1</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
  <span class="n">W2</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">v</span><span class="o">.</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

  <span class="k">return</span> <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span>
<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-21">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-21">&#182;</a>
  </div>
  <p><code>u</code> and <code>c</code> can be computed from Riemann invariants as <span class="math display">\[
  u = \frac{1}{2} (W_1 + w_2), \quad c = \frac{W_2 - W_1}{8}.
\]</span></p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-22">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-22">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>rI2uc</code></strong> <span class="math inline">\(\rightarrow\)</span> <code>W1::Float</code>, <code>w2::Float</code></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>i</code></td>
<td align="left"><code>::Float</code> cell index.</td>
</tr>
<tr class="even">
<td align="left"><code>v</code></td>
<td align="left"><code>::Vessel</code> vessel data structure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Returns:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>u</code></td>
<td align="left"><code>::Float</code> longitudinal velocity.</td>
</tr>
<tr class="even">
<td align="left"><code>c</code></td>
<td align="left"><code>::Float</code> wave speed.</td>
</tr>
</tbody>
</table>
<p><a name="rI2uc"></a></p>

</td>
<td class="code">
<div class="highlight"><pre><span class="k">function</span><span class="nf"> rI2uc</span><span class="p">(</span><span class="n">W1</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">,</span> <span class="n">W2</span> <span class="p">::</span> <span class="kt">Float64</span><span class="p">)</span>
  <span class="n">u</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">W1</span> <span class="o">+</span> <span class="n">W2</span><span class="p">)</span>
  <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">W2</span> <span class="o">-</span> <span class="n">W1</span><span class="p">)</span><span class="o">*</span><span class="mf">0.125</span>

  <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">c</span>
<span class="k">end</span>


</pre></div>
</td>
</tr>

<tr id="section-23">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-23">&#182;</a>
  </div>
  <p><em>function</em> <strong><code>calculatePrimitives</code></strong></p>
<table>
<colgroup>
<col width="22%" />
<col width="77%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Parameters:</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code>v</code></td>
<td align="left"><code>::Vessel</code> vessel data structure.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Functioning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">This function updates all primitives variables at once.</td>
</tr>
</tbody>
</table>
<p><a name="calculatePrimitives"></a> function calculatePrimitives(v :: Vessel)</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-24">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-24">&#182;</a>
  </div>
  <p>v.P = pressure(v.A, v.A0, v.beta) v.u = v.Q./v.A v.c = waveSpeed(v.A, v.gamma)</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

<tr id="section-25">
<td class="docs">
  <div class="pilwrap">
    <a class="pilcrow" href="#section-25">&#182;</a>
  </div>
  <p>end</p>

</td>
<td class="code">
<div class="highlight"><pre>

</pre></div>
</td>
</tr>

      </tbody>
    </table>
  </div>
<nav>
  <ul>
    <li><a href="#">^</a></li>
    <li><a href="../doc-index.html">API index</a></li>
  </ul>
</nav>
</body>
</html>